
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Assignment 1 &#8212; ML Engineering</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/banner.jpeg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">ML Engineering</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Welcome
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../labs/Lab%200%20-%20Prerequisites.html">
   Prerequisites
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Lectures
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../notebooks/01%20-%20Introduction.html">
   Lecture 1: Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../notebooks/02%20-%20Linear%20Models.html">
   Lecture 2: Linear models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../notebooks/03%20-%20Kernelization.html">
   Lecture 3: Kernelization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../notebooks/04%20-%20Model%20Selection.html">
   Lecture 4: Model Selection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../notebooks/05%20-%20Ensemble%20Learning.html">
   Lecture 5. Ensemble Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../notebooks/06%20-%20Data%20Preprocessing.html">
   Lecture 6. Data preprocessing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../notebooks/07%20-%20Bayesian%20Learning.html">
   Lecture 7. Bayesian Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../notebooks/08%20-%20Neural%20Networks.html">
   Lecture 8. Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../notebooks/09%20-%20Convolutional%20Neural%20Networks.html">
   Lecture 9: Convolutional Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../notebooks/10%20-%20Neural%20Networks%20for%20text.html">
   Lecture 10. Neural Networks for text
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Labs
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../labs/Lab%201a%20-%20Linear%20Models%20for%20Regression.html">
   Lab 1a: Linear regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../labs/Lab%201b%20-%20Linear%20Models%20for%20Classification.html">
   Lab 1b: Linear classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../labs/Lab%202%20-%20Kernelization.html">
   Lab 2: Kernelization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../labs/Lab%203a%20-%20Model%20Selection.html">
   Lab 3a: Model selection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../labs/Lab%203b%20-%20Ensembles.html">
   Lab 3b: Ensembles
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../labs/Lab%204%20-%20Pipelines.html">
   Lab 4:  Data preprocessing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../labs/Lab%205%20-%20Bayesian%20learning.html">
   Lab 5: Bayesian models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../labs/Lab%206%20-%20Neural%20Networks.html">
   Lab 6: Neural networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../labs/Lab%207a%20-%20Convolutional%20Neural%20Networks.html">
   Lab 7a: Convolutional neural nets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../labs/Lab%207b%20-%20Neural%20Networks%20for%20text.html">
   Lab 7b: Neural Networks for text
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../labs/Lab%208%20-%20AutoML.html">
   Lab 8: AutoML
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tutorials
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../notebooks/Tutorial%201%20-%20Python.html">
   Python for data analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../notebooks/Tutorial%202%20-%20Python%20for%20Data%20Analysis.html">
   Python for scientific computing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../notebooks/Tutorial%203%20-%20Machine%20Learning%20in%20Python.html">
   Machine Learning in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../notebooks/Tutorial%204%20-%20Decision%20Trees.html">
   Recap: Decision Trees
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../notebooks/Tutorial%205%20-%20Nearest%20Neighbors.html">
   Recap: k-Nearest Neighbor
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../labs/Lab%201%20-%20Tutorial.html">
   Lab 1: Machine Learning with Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../labs/Lab%203%20-%20Tutorial.html">
   Lab 3 Tutorial: Model Selection in scikit-learn
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../labs/Lab%204%20-%20Tutorial.html">
   Lab 4 Tutorial: Data engineering pipelines
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../labs/Lab%206%20-%20Tutorial.html">
   Lab 6 Tutorial: Deep Learning with TensorFlow
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../labs/Lab%207%20-%20Tutorial.html">
   Lab 7 Tutorial: Deep Learning for text
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/assignments/Assignment_1_Model_Solution.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/ml-course/master"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/ml-course/master/issues/new?title=Issue%20on%20page%20%2Fassignments/Assignment_1_Model_Solution.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/ml-course/master/master?urlpath=tree/assignments/Assignment_1_Model_Solution.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/ml-course/master/blob/master/assignments/Assignment_1_Model_Solution.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#peeking-at-the-data">
   Peeking at the data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#question-1-1-cross-validate-1-point">
   Question 1.1: Cross-validate (1 point)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#question-1-2-tune-1-points">
   Question 1.2: Tune (1 points)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#question-1-3-interpretation-1-point">
   Question 1.3: Interpretation (1 point)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#question-2-1-model-inspection-2-points">
   Question 2.1: Model inspection (2 points)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#question-2-2-interpretation-1-points">
   Question 2.2: Interpretation (1 points)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#question-3-1-mistake-analysis-2-point">
   Question 3.1: Mistake analysis (2 point)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#question-3-2-interpretation-1-point">
   Question 3.2: Interpretation (1 point)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#question-4-1-point">
   Question 4 (1 point)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#question-5-bonus-question">
   Question 5: Bonus question
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#question-5-1-hog-features-1-point">
     Question 5.1 : HOG features (1 point)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#question-5-2-a-better-model-1-point">
   Question 5.2 : A better model? (1 point)
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Assignment 1</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#peeking-at-the-data">
   Peeking at the data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#question-1-1-cross-validate-1-point">
   Question 1.1: Cross-validate (1 point)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#question-1-2-tune-1-points">
   Question 1.2: Tune (1 points)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#question-1-3-interpretation-1-point">
   Question 1.3: Interpretation (1 point)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#question-2-1-model-inspection-2-points">
   Question 2.1: Model inspection (2 points)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#question-2-2-interpretation-1-points">
   Question 2.2: Interpretation (1 points)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#question-3-1-mistake-analysis-2-point">
   Question 3.1: Mistake analysis (2 point)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#question-3-2-interpretation-1-point">
   Question 3.2: Interpretation (1 point)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#question-4-1-point">
   Question 4 (1 point)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#question-5-bonus-question">
   Question 5: Bonus question
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#question-5-1-hog-features-1-point">
     Question 5.1 : HOG features (1 point)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#question-5-2-a-better-model-1-point">
   Question 5.2 : A better model? (1 point)
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fill in your name using the given format</span>
<span class="n">your_name</span> <span class="o">=</span> <span class="s2">&quot;LAST_NAME, FIRST_NAME&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># For use in colab</span>
<span class="k">if</span> <span class="s1">&#39;google.colab&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">get_ipython</span><span class="p">()):</span>
  <span class="o">!</span>pip install openml --quiet
</pre></div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="assignment-1">
<h1>Assignment 1<a class="headerlink" href="#assignment-1" title="Permalink to this headline">¶</a></h1>
<p>We will study classifiers on the <a class="reference external" href="https://www.openml.org/d/41982">Kuzushiji dataset</a>.
As you can <a class="reference external" href="https://arxiv.org/abs/1812.01718">read in the paper</a>, Kuzushiji is a handwritten
Japanese script that was used for thousands of years, but most Japanese natives cannot read
it anymore. We’ll try to use machine learning to recognize the characters, and translate them to
modern Japanese (Hiragana) characters.</p>
<p>The dataset that we will use contains scanned 28-by-28 pixel images of such handwritten characters. Actually, only 10 of those characters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># imports</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">openml</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">tqdm</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="c1"># Pre-flight checklist. Do not change this code.</span>
<span class="c1"># Make sure that you have installed recent versions of key packages.</span>
<span class="kn">from</span> <span class="nn">packaging</span> <span class="kn">import</span> <span class="n">version</span>
<span class="kn">import</span> <span class="nn">sklearn</span>
<span class="n">sklearn_version</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">__version__</span>
<span class="k">if</span> <span class="n">version</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">sklearn_version</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">version</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;1.0.2&quot;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;scikit-learn is outdated: </span><span class="si">{}</span><span class="s2">. Please update now! pip install -U scikit-learn&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sklearn_version</span><span class="p">))</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;OK. You may continue :)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>OK. You may continue :)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download Kuzushiji-MNIST data. Takes a while the first time.</span>
<span class="c1"># You may receive a warning about data compression but you can ignore that.</span>
<span class="c1"># Don&#39;t overwrite the X and y variables anywhere in this notebook. </span>
<span class="c1"># Seriously, don&#39;t.</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">openml</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">get_dataset</span><span class="p">(</span><span class="mi">41982</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">default_target_attribute</span><span class="p">);</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">/</span><span class="mi">255</span> <span class="c1"># Simple scaling </span>

<span class="c1"># These are the names of the modern characters (our 10 classes)</span>
<span class="n">data_classes</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;ki&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;su&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;tsu&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="s2">&quot;na&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="s2">&quot;ha&quot;</span><span class="p">,</span> 
                <span class="mi">6</span><span class="p">:</span> <span class="s2">&quot;ma&quot;</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="s2">&quot;ya&quot;</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="s2">&quot;re&quot;</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="s2">&quot;wo&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plotting helper functions. Don&#39;t edit these.</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span> <span class="nn">IPython</span> <span class="kn">import</span> <span class="n">display</span>
<span class="kn">from</span> <span class="nn">tqdm.notebook</span> <span class="kn">import</span> <span class="n">tqdm_notebook</span>

<span class="k">def</span> <span class="nf">plot_live</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">evaluator</span><span class="p">,</span> <span class="n">param_name</span><span class="p">,</span> <span class="n">param_range</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;score&#39;</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Renders a plot that updates with every evaluation from the evaluator.</span>
<span class="sd">    Keyword arguments:</span>
<span class="sd">    X -- the data for training and testing</span>
<span class="sd">    y -- the correct labels</span>
<span class="sd">    evaluator -- a function with signature (X, y, param_value) that returns a dictionary of scores.</span>
<span class="sd">                 Examples: {&quot;train&quot;: 0.9, &quot;test&quot;: 0.95} or {&quot;model_1&quot;: 0.9, &quot;model_2&quot;: 0.7}</span>
<span class="sd">    param_name -- the parameter that is being varied on the X axis. Can be a hyperparameter, sample size,...</span>
<span class="sd">    param_range -- list of all possible values on the x-axis</span>
<span class="sd">    scale -- defines which scale to plot the x-axis on, either &#39;log&#39; (logarithmic) or &#39;linear&#39;</span>
<span class="sd">    ylim -- tuple with the lowest and highest y-value to plot (e.g. (0, 1))</span>
<span class="sd">    ylabel -- the y-axis title</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Plot interactively</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">param_name</span><span class="p">)</span>
    
    <span class="c1"># Make the scale look nice</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">param_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">param_range</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
        
    <span class="c1"># Start from empty plot, then fill it</span>
    <span class="n">series</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">xvals</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm_notebook</span><span class="p">(</span><span class="n">param_range</span><span class="p">):</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="n">evaluator</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> 
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">param_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="c1"># initialize series</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">scores</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">lines</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="p">[],</span> <span class="n">marker</span> <span class="o">=</span> <span class="n">marker</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">k</span><span class="p">)</span>
                <span class="n">series</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">xvals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">scores</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> <span class="c1"># append new data</span>
            <span class="n">series</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scores</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="n">lines</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">series</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="c1"># refresh plot</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">display</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">())</span>
        <span class="n">display</span><span class="o">.</span><span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Plots data instances as 28x28 images</span>
<span class="k">def</span> <span class="nf">plot_examples</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">row_length</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Renders a set of images</span>
<span class="sd">    images -- an array of 28x28 images as 1D vectors</span>
<span class="sd">    labels -- the corresponding labels for each image</span>
<span class="sd">    row_length -- how many images should be shown per line</span>
<span class="sd">    title -- a title for the produced figure</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nr_rows</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">images</span><span class="p">)</span> <span class="o">/</span> <span class="n">row_length</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">images</span><span class="p">)</span> <span class="o">%</span> <span class="n">row_length</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">nr_rows</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nr_rows</span><span class="p">,</span> <span class="n">row_length</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">1.5</span> <span class="o">*</span> <span class="n">row_length</span><span class="p">,</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">nr_rows</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">images</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">images</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">row_length</span><span class="p">:</span>
            <span class="n">axes</span><span class="p">[</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="n">row_length</span><span class="p">)][</span><span class="n">i</span><span class="o">%</span><span class="k">row_length</span>].imshow(n.reshape(28, 28), cmap=plt.cm.gray_r)
            <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
              <span class="n">axes</span><span class="p">[</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="n">row_length</span><span class="p">)][</span><span class="n">i</span><span class="o">%</span><span class="k">row_length</span>].set_xlabel(data_classes[int(labels[i])])
            <span class="n">axes</span><span class="p">[</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="n">row_length</span><span class="p">)][</span><span class="n">i</span><span class="o">%</span><span class="k">row_length</span>].set_xticks(())
            <span class="n">axes</span><span class="p">[</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="n">row_length</span><span class="p">)][</span><span class="n">i</span><span class="o">%</span><span class="k">row_length</span>].set_yticks(())

        <span class="k">else</span><span class="p">:</span>
            <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray_r</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
              <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">data_classes</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">])])</span>
            <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(())</span>
            <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(())</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>       
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>

<span class="c1"># Plots the coefficients of the given model as 28x28 heatmaps. </span>
<span class="k">def</span> <span class="nf">plot_coefficients</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Renders a 28x28 heatmap of the model&#39;s trained coefficients.</span>
<span class="sd">    Keyword arguments:</span>
<span class="sd">    coef -- the model coefficients</span>
<span class="sd">    name -- a title for the produced figure</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">coef</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span><span class="mi">28</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(()),</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(())</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="peeking-at-the-data">
<h2>Peeking at the data<a class="headerlink" href="#peeking-at-the-data" title="Permalink to this headline">¶</a></h2>
<p>If we plot the characters, we see that there is quite some variation. The same
character can be written in a number of different ways.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Gets indices of examples with the given class</span>
<span class="k">def</span> <span class="nf">y_class</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">y</span><span class="p">[</span><span class="n">y</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">10</span><span class="p">:</span><span class="mi">20</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">plot_examples</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[</span><span class="n">y_class</span><span class="p">(</span><span class="n">i</span><span class="p">)],</span> <span class="n">y</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[</span><span class="n">y_class</span><span class="p">(</span><span class="n">i</span><span class="p">)],</span> 
                  <span class="n">row_length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">data_classes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Assignment_1_Model_Solution_7_0.png" src="../_images/Assignment_1_Model_Solution_7_0.png" />
<img alt="../_images/Assignment_1_Model_Solution_7_1.png" src="../_images/Assignment_1_Model_Solution_7_1.png" />
<img alt="../_images/Assignment_1_Model_Solution_7_2.png" src="../_images/Assignment_1_Model_Solution_7_2.png" />
<img alt="../_images/Assignment_1_Model_Solution_7_3.png" src="../_images/Assignment_1_Model_Solution_7_3.png" />
<img alt="../_images/Assignment_1_Model_Solution_7_4.png" src="../_images/Assignment_1_Model_Solution_7_4.png" />
<img alt="../_images/Assignment_1_Model_Solution_7_5.png" src="../_images/Assignment_1_Model_Solution_7_5.png" />
<img alt="../_images/Assignment_1_Model_Solution_7_6.png" src="../_images/Assignment_1_Model_Solution_7_6.png" />
<img alt="../_images/Assignment_1_Model_Solution_7_7.png" src="../_images/Assignment_1_Model_Solution_7_7.png" />
<img alt="../_images/Assignment_1_Model_Solution_7_8.png" src="../_images/Assignment_1_Model_Solution_7_8.png" />
<img alt="../_images/Assignment_1_Model_Solution_7_9.png" src="../_images/Assignment_1_Model_Solution_7_9.png" />
</div>
</div>
</div>
<div class="section" id="question-1-1-cross-validate-1-point">
<h2>Question 1.1: Cross-validate (1 point)<a class="headerlink" href="#question-1-1-cross-validate-1-point" title="Permalink to this headline">¶</a></h2>
<p>Implement a method <code class="docutils literal notranslate"><span class="pre">evaluate_LR</span></code> that evaluates a Logistic Regression model for a given regularization constant (C) and returns the train and test score of a 5-fold stratified cross-validation using the accuracy metric. Note: we know that Logistic Regression is not the best technique for image data :). We’ll use other techniques in future assignments.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Implement</span>
<span class="k">def</span> <span class="nf">evaluate_LR</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Evaluate an SVM with 5-fold cross-validation on the provided (X, y) data. </span>
<span class="sd">    Keyword arguments:</span>
<span class="sd">    X -- the data for training and testing</span>
<span class="sd">    y -- the correct labels</span>
<span class="sd">    C -- the value for the regularization hyperparameter</span>
<span class="sd">    </span>
<span class="sd">    Returns: a dictionary with the mean train and test score, e.g. {&quot;train&quot;: 0.9, &quot;test&quot;: 0.95}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># MODEL IMPLEMENTATION:</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_validate</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="k">def</span> <span class="nf">evaluate_LR</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Evaluate an SVM with 5-fold cross-validation on the provided (X, y) data. </span>
<span class="sd">    Keyword arguments:</span>
<span class="sd">    X -- the data for training and testing</span>
<span class="sd">    y -- the correct labels</span>
<span class="sd">    C -- the value for the regularization hyperparameter</span>
<span class="sd">    </span>
<span class="sd">    Returns: a dictionary with the mean train and test score, e.g. {&quot;train&quot;: 0.9, &quot;test&quot;: 0.95}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">score</span> <span class="o">=</span> <span class="n">cross_validate</span><span class="p">(</span><span class="n">LogisticRegression</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="n">C</span><span class="p">),</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">return_train_score</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;train&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">score</span><span class="p">[</span><span class="s1">&#39;train_score&#39;</span><span class="p">]),</span>
           <span class="s1">&#39;test&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">score</span><span class="p">[</span><span class="s1">&#39;test_score&#39;</span><span class="p">])}</span>
    <span class="k">return</span> <span class="n">res</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="question-1-2-tune-1-points">
<h2>Question 1.2: Tune (1 points)<a class="headerlink" href="#question-1-2-tune-1-points" title="Permalink to this headline">¶</a></h2>
<p>Implement a method <code class="docutils literal notranslate"><span class="pre">plot_curve</span></code> that plots the results of <code class="docutils literal notranslate"><span class="pre">evaluate_LR</span></code> on a 25% stratified subsample of the Kuzushiji MNIST dataset for gamma values ranging from 1e-8 to 1e3 (on a log scale, at least 12 values), and C=1. Use <code class="docutils literal notranslate"><span class="pre">random_state=0</span></code>. You can use the plotting function <code class="docutils literal notranslate"><span class="pre">plot_live</span></code> defined above (carefully read what it does), and add any helper functions you like. Note:  To be clear, you need to pass only 25% of the data to <code class="docutils literal notranslate"><span class="pre">evaluate_LR</span></code>. Using a 25% subsample won’t give you optimal performance, but this is meant to make the assignment more doable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Implement. Do not change the name or signature of this function.</span>
<span class="k">def</span> <span class="nf">plot_curve</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Plots the train and test accuracy of logistic regression on a 25% </span>
<span class="sd">    subsample of the given data for different amounts of regularization.</span>
<span class="sd">    X -- the data for training and testing</span>
<span class="sd">    y -- the correct labels</span>
<span class="sd">    </span>
<span class="sd">    Returns: a plot as described above, with C on the x-axis and accuracy on </span>
<span class="sd">    the y-axis. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
<span class="n">plot_curve</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># MODEL IMPLEMENTATION</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="k">def</span> <span class="nf">plot_curve</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="n">Xs</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plot_live</span><span class="p">(</span><span class="n">Xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">evaluate_LR</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.1</span><span class="p">))</span>
<span class="n">plot_curve</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Assignment_1_Model_Solution_13_0.png" src="../_images/Assignment_1_Model_Solution_13_0.png" />
</div>
</div>
</div>
<div class="section" id="question-1-3-interpretation-1-point">
<h2>Question 1.3: Interpretation (1 point)<a class="headerlink" href="#question-1-3-interpretation-1-point" title="Permalink to this headline">¶</a></h2>
<p>Interpret the graph. At C=1e-6, is the model underfitting, overfitting, or neither? What about the model trained with C=100? Below are a number of possible interpretations. Enter the correct letter in value <code class="docutils literal notranslate"><span class="pre">q_1.3</span></code> in the code.</p>
<ul class="simple">
<li><p>‘A’: Underfitting at C=1e-6, overfitting at C=100.</p></li>
<li><p>‘B’: Overfitting at C=1e-6, underfitting at C=100.</p></li>
<li><p>‘C’: Neither underfitting nor overfitting at C=1e-6, overfitting at C=100.</p></li>
<li><p>‘D’: Neither underfitting nor overfitting at C=1e-6, underfitting at C=100.</p></li>
<li><p>‘E’: Overfitting at C=1e-6, neither underfitting nor overfitting at C=100.</p></li>
<li><p>‘F’: Underfitting at C=1e-6, neither underfitting nor overfitting at C=100.</p></li>
<li><p>‘G’: Neither underfitting nor overfitting at both values for C.</p></li>
<li><p>‘H’: No answer</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fill in the correct answer. Don&#39;t change the name of the variable</span>
<span class="n">q_1_3</span> <span class="o">=</span> <span class="s1">&#39;H&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># MODEL SOLUTION</span>
<span class="c1"># The answer is A. At C=1e-6, the model is underfitting (both training and test score are low). </span>
<span class="c1"># At C=100, the model is overfitting (high training score but low test score). </span>
<span class="c1"># Indeed, a higher C value means less regularization. The best model uses C=0.01. </span>
<span class="n">q_1_3</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="question-2-1-model-inspection-2-points">
<h2>Question 2.1: Model inspection (2 points)<a class="headerlink" href="#question-2-1-model-inspection-2-points" title="Permalink to this headline">¶</a></h2>
<p>Implement a function <code class="docutils literal notranslate"><span class="pre">plot_tsu_coefficients</span></code> that plots a heatmap of the coefficients of three models (after training), one trained with C=1e-6, one with C=0.01, and one with C=10. You can use the <code class="docutils literal notranslate"><span class="pre">plot_coefficients</span></code> helper function (see above). Only plot the coefficients of the model that separates the character <code class="docutils literal notranslate"><span class="pre">tsu</span></code> from the other characters. You can assume that a one-vs-rest-like approach is used for multi-class problems, hence the n-th set of coefficients belong to the model that separates the n-th class. You should get three plots in total.</p>
<p>First split the data in a default stratified train-test split. Train the models on the training data and score the accuracy on the test data. Add the C-value and accuracy to the title of the plots.</p>
<p>Note: You may get convergence warnings. If so, just increase the number of optimization iterations (<code class="docutils literal notranslate"><span class="pre">max_iter</span></code>). Especially models with high C values can take longer to converge (can you guess why?). You can also choose to ignore these warnings since they won’t affect the results much.<br />
Note 2: Scikit-learn actually uses <a class="reference external" href="https://scikit-learn.org/stable/auto_examples/linear_model/plot_logistic_multinomial.html#sphx-glr-auto-examples-linear-model-plot-logistic-multinomial-py">a more sophisticated approach</a> here than simple one-vs-all. It uses the fact that Logistic Regression predicts probabilities, and hence the probabilities of each class are taken into account (in a softmax function). It will still produce one model per class.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Implement. Do not change the name or signature of this function.</span>
<span class="k">def</span> <span class="nf">plot_tsu_coefficients</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Plots 28x28 heatmaps showing the coefficients of three Logistic </span>
<span class="sd">    Regression models, each with different amounts of regularization values.</span>
<span class="sd">    X -- the data for training and testing</span>
<span class="sd">    y -- the correct labels</span>
<span class="sd">    </span>
<span class="sd">    Returns: 3 plots, as described above.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
<span class="n">plot_tsu_coefficients</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### MODEL SOLUTION</span>
<span class="k">def</span> <span class="nf">plot_tsu_coefficients</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
  <span class="c1"># Simple stratified train-test split</span>
  <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
  <span class="c1"># 3 plots</span>
  <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">10e-6</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">100</span><span class="p">]:</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span> <span class="c1"># train</span>
    <span class="n">acc</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span> <span class="c1"># score</span>
    <span class="n">plot_coefficients</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="s2">&quot;LR (C=</span><span class="si">{}</span><span class="s2">), ACC:</span><span class="si">{:.4f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">acc</span><span class="p">))</span> <span class="c1"># plot for class 3 (tsu)</span>
<span class="n">plot_tsu_coefficients</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/jvanscho/miniforge3/lib/python3.9/site-packages/sklearn/linear_model/_logistic.py:814: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
</pre></div>
</div>
<img alt="../_images/Assignment_1_Model_Solution_19_1.png" src="../_images/Assignment_1_Model_Solution_19_1.png" />
<img alt="../_images/Assignment_1_Model_Solution_19_2.png" src="../_images/Assignment_1_Model_Solution_19_2.png" />
<img alt="../_images/Assignment_1_Model_Solution_19_3.png" src="../_images/Assignment_1_Model_Solution_19_3.png" />
</div>
</div>
</div>
<div class="section" id="question-2-2-interpretation-1-points">
<h2>Question 2.2: Interpretation (1 points)<a class="headerlink" href="#question-2-2-interpretation-1-points" title="Permalink to this headline">¶</a></h2>
<p>Interpret the results. Which model works best? What is each of the models paying attention to when making predictions? Does that make sense - i.e. did the model learn something useful about the character <em>tsu</em>? Compare this to the results of question 1.2 and 1.3: does that help explain the results? Please formulate your answer in the string variable below. Keep your answer within 500 characters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q_2_2</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Your answer </span>
<span class="s2">        &quot;&quot;&quot;</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">q_2_2</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">500</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Answer is </span><span class="si">{}</span><span class="s2"> characters long. Please shorten it to 500 characters.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">q_2_2</span><span class="o">.</span><span class="n">strip</span><span class="p">())))</span>
</pre></div>
</div>
</div>
</div>
<p>Model solution: The first plot shows a very smooth shape, this is the most common way of writing ‘tsu’ but it also misses many of the nuances. This model is clearly underfitting. It’s too simple. This is also reflected in the accuracy score. The third figure is very noisy, which is a sign of overfitting: the model is too complex and doesn’t generalize anymore. The middle plot has the best score and also has a good balance in capturing the different ways to write ‘tsu’.</p>
</div>
<div class="section" id="question-3-1-mistake-analysis-2-point">
<h2>Question 3.1: Mistake analysis (2 point)<a class="headerlink" href="#question-3-1-mistake-analysis-2-point" title="Permalink to this headline">¶</a></h2>
<p>Let’s focus more on the character ‘tsu’ and the behavior of the model with C=1e-6.</p>
<p>First split the data again in a default stratified train-test split. Train the models on the training data and produce the predictions on the test data.</p>
<p>Next, take the test examples which actually represent ‘tsu’. From these, identify the ones which are predicted correctly and which ones are not.</p>
<p>Finally, plot these examples using the <code class="docutils literal notranslate"><span class="pre">plot_examples</span></code> function, together with the predicted class (character). Create two plots (e.g. by calling <code class="docutils literal notranslate"><span class="pre">plot_examples</span></code> twice): one with 20 examples of ‘tsu’ characters which are predicted correctly, and a second with 20 examples of ‘tsu’ characters which are predicted incorrectly by this model. Indicate in the figure <code class="docutils literal notranslate"><span class="pre">title</span></code> which ‘tsu’ characters are correct and which ones are misclassified.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Implement. Do not change the name or signature of this function.</span>
<span class="k">def</span> <span class="nf">plot_mistakes</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Plots two sets of images. The first set shows 20 examples of characters</span>
<span class="sd">    predicted correctly by a Logistic Regression classifier with C=1e-6. The </span>
<span class="sd">    second set shows 20 examples of misclassifications. </span>
<span class="sd">    X -- the data for training and testing</span>
<span class="sd">    y -- the correct labels</span>
<span class="sd">    Returns: 2 sets of plots, as described above.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
<span class="n">plot_mistakes</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># MODEL IMPLEMENTATION</span>
<span class="k">def</span> <span class="nf">plot_mistakes</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">actual_tsu</span> <span class="o">=</span> <span class="n">y_test</span> <span class="o">==</span> <span class="s1">&#39;3&#39;</span> <span class="c1"># actual test examples of tsu</span>
    <span class="n">pred_tsu</span> <span class="o">=</span> <span class="n">y_pred</span> <span class="o">==</span> <span class="s1">&#39;3&#39;</span> <span class="c1"># cases where the model thinks it&#39;s tsu</span>
    <span class="n">bad_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">actual_tsu</span><span class="p">,</span> <span class="n">pred_tsu</span> <span class="o">!=</span> <span class="n">actual_tsu</span><span class="p">)</span> <span class="c1"># unrecognized tsu</span>
    <span class="n">good_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">actual_tsu</span><span class="p">,</span> <span class="n">pred_tsu</span> <span class="o">==</span> <span class="n">actual_tsu</span><span class="p">)</span> <span class="c1"># recognized tsu</span>
    <span class="n">plot_examples</span><span class="p">(</span><span class="n">X_test</span><span class="p">[</span><span class="n">good_mask</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">20</span><span class="p">],</span> <span class="n">y_pred</span><span class="p">[</span><span class="n">good_mask</span><span class="p">],</span> <span class="n">row_length</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Correct predictions&quot;</span><span class="p">)</span>
    <span class="n">plot_examples</span><span class="p">(</span><span class="n">X_test</span><span class="p">[</span><span class="n">bad_mask</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">20</span><span class="p">],</span> <span class="n">y_pred</span><span class="p">[</span><span class="n">bad_mask</span><span class="p">],</span> <span class="n">row_length</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Misclassifications&quot;</span><span class="p">)</span>
<span class="n">plot_mistakes</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Assignment_1_Model_Solution_25_0.png" src="../_images/Assignment_1_Model_Solution_25_0.png" />
<img alt="../_images/Assignment_1_Model_Solution_25_1.png" src="../_images/Assignment_1_Model_Solution_25_1.png" />
</div>
</div>
</div>
<div class="section" id="question-3-2-interpretation-1-point">
<h2>Question 3.2: Interpretation (1 point)<a class="headerlink" href="#question-3-2-interpretation-1-point" title="Permalink to this headline">¶</a></h2>
<p>Interpret the results. Can you explain which kinds of ‘tsu’ characters are predicted correctly and which ones are not? Compare this with what you observed in question 2.1 and 2.2. What does that tell you about the model? Please formulate your answer in the string variable below. Keep your answer within 500 characters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q_3_2</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Your answer </span>
<span class="s2">        &quot;&quot;&quot;</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">q_3_2</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">500</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Answer is </span><span class="si">{}</span><span class="s2"> characters long. Please shorten it to 500 characters.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">q_3_2</span><span class="o">.</span><span class="n">strip</span><span class="p">())))</span>
</pre></div>
</div>
</div>
</div>
<p>Model solution: It is clear that only the simple, ‘round’ versions of ‘tsu’ are predicted correctly, i.e. those that match the shape of the highly activated coefficients in the underfitted model. The other way of writing ‘tsu’ is not at all recognized by the underfitted model. Hence, this model, being forced to be simple (highly regularized), was only able to learn the simpler shape of this character. It was not flexible enough to learn that there are actually two ways to write it.</p>
</div>
<div class="section" id="question-4-1-point">
<h2>Question 4 (1 point)<a class="headerlink" href="#question-4-1-point" title="Permalink to this headline">¶</a></h2>
<p>Archeologists found an ancient text in the mountain cave temples of Shodoshima, which is partially decifered into the following sentence:</p>
<hr class="docutils" />
<p><strong>&lt;word 1&gt;</strong> LOOKS BEAUTIFUL OVER THE <strong>&lt;word 2&gt;</strong></p>
<hr class="docutils" />
<p>They need your help to uncover the meaning of the missing characters and expand our knowledge on early Japanese literature.</p>
<p>They sent us pictures of the missing characters in the form of 28x28 numpy arrays (because why not). The code below imports them into the notebook. Both words consist of two characters as shown below. The first two characters form the first word and the last two form the second.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># !pip install gdown # uncomment to install the downloader</span>
<span class="kn">import</span> <span class="nn">gdown</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://drive.google.com/uc?id=1CcnG1a6feMd7n8rOph_nSBf29ltuJ9no&#39;</span>
<span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;mystery_characters.npy&#39;</span>
<span class="n">gdown</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">temple_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;mystery_characters.npy&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading...
From: https://drive.google.com/uc?id=1CcnG1a6feMd7n8rOph_nSBf29ltuJ9no
To: /Users/jvanscho/Documents/mlcourse/master/assignments/mystery_characters.npy
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|                                                                                                  | 0.00/25.2k [00:00&lt;?, ?B/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████████████████████████████████████████████████████████████████████████████████████| 25.2k/25.2k [00:00&lt;00:00, 724kB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_examples</span><span class="p">(</span><span class="n">temple_data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="n">row_length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Word 1&quot;</span><span class="p">)</span>
<span class="n">plot_examples</span><span class="p">(</span><span class="n">temple_data</span><span class="p">[</span><span class="mi">2</span><span class="p">:],</span> <span class="kc">None</span><span class="p">,</span> <span class="n">row_length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Word 2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Assignment_1_Model_Solution_31_0.png" src="../_images/Assignment_1_Model_Solution_31_0.png" />
<img alt="../_images/Assignment_1_Model_Solution_31_1.png" src="../_images/Assignment_1_Model_Solution_31_1.png" />
</div>
</div>
<p>Use your best model from question 1.2 to classify these images. Implement a small method <code class="docutils literal notranslate"><span class="pre">predict_characters</span></code> that prints the right classes (e.g. ‘tsu’)given an array of character. Once you have translated them into modern Japanese, translate them to English and type the two words in the variables <code class="docutils literal notranslate"><span class="pre">q_4_word_1</span></code> and <code class="docutils literal notranslate"><span class="pre">q_4_word_2</span></code>.</p>
<p>Hint: You can use Google Translate if you don’t know Japanese. Enter the words in Google Translate without spaces between the characters. There may be multiple meanings for a word, you can pick the one that fits the sentence best.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Implement. Do not change the name or signature of this function.</span>
<span class="k">def</span> <span class="nf">predict_characters</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X_test</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Print the class names for all the images in X.</span>
<span class="sd">    X -- the data for training and testing</span>
<span class="sd">    y -- the correct labels</span>
<span class="sd">    X_test -- the new input images as 1D arrays</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>

<span class="n">predict_characters</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">temple_data</span><span class="p">)</span>

<span class="c1"># Fill in the correct meaning</span>
<span class="n">q_4_word_1</span> <span class="o">=</span> <span class="s2">&quot;??&quot;</span>
<span class="n">q_4_word_2</span> <span class="o">=</span> <span class="s2">&quot;??&quot;</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The sentence is : </span><span class="si">{}</span><span class="s2"> looks beautiful over the </span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">q_4_word_1</span><span class="p">,</span><span class="n">q_4_word_2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The sentence is : ?? looks beautiful over the ??.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># MODEL IMPLEMENTATION</span>
<span class="k">def</span> <span class="nf">predict_characters</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">X_test</span><span class="p">):</span>
  <span class="c1"># Passing only the values (not the feature names) to avoid warnings about that</span>
  <span class="n">X_train</span><span class="p">,</span><span class="n">_</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
  <span class="n">model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span> <span class="c1"># train</span>
  <span class="n">predicted</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data_classes</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">predicted</span><span class="p">[</span><span class="mi">0</span><span class="p">])],</span><span class="n">data_classes</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">predicted</span><span class="p">[</span><span class="mi">1</span><span class="p">])]))</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data_classes</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">predicted</span><span class="p">[</span><span class="mi">2</span><span class="p">])],</span><span class="n">data_classes</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">predicted</span><span class="p">[</span><span class="mi">3</span><span class="p">])]))</span>

<span class="n">predict_characters</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">temple_data</span><span class="p">)</span>

<span class="n">q_4_word_1</span> <span class="o">=</span> <span class="s2">&quot;Moon&quot;</span>
<span class="n">q_4_word_2</span> <span class="o">=</span> <span class="s2">&quot;Mountain&quot;</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The sentence is : </span><span class="si">{}</span><span class="s2"> looks beautiful over the </span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">q_4_word_1</span><span class="p">,</span><span class="n">q_4_word_2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tsu ki
ya ma
The sentence is : Moon looks beautiful over the Mountain.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="question-5-bonus-question">
<h2>Question 5: Bonus question<a class="headerlink" href="#question-5-bonus-question" title="Permalink to this headline">¶</a></h2>
<div class="section" id="question-5-1-hog-features-1-point">
<h3>Question 5.1 : HOG features (1 point)<a class="headerlink" href="#question-5-1-hog-features-1-point" title="Permalink to this headline">¶</a></h3>
<p>Until now, we only used the pixel representation. There are may other ways of feature representation that work much better. One of these is the histogram of oriented gradients (HOG), which counts the occurrences of gradient orientations in localized portions of an image. You can read more about HOG feature descriptors <a class="reference external" href="https://towardsdatascience.com/hog-histogram-of-oriented-gradients-67ecd887675f">here</a>.</p>
<p>Using the <strong>scikit-image</strong> implementation, compute the hog features of an image containing the <em>tsu</em> character. You can have a look at this <a class="reference external" href="https://scikit-image.org/docs/stable/auto_examples/features_detection/plot_hog.html">tutorial</a>. Implement a method <code class="docutils literal notranslate"><span class="pre">plot_hog_feature</span></code> showing an original image and its hog representation side by side. Play with different cell sizes to get a visually better representation. Finally, implement a method <code class="docutils literal notranslate"><span class="pre">plot_hog_features</span></code> that plots multiple cell sizes at once.</p>
<p>This question is deliberative more free-from. You can make your own decisions as long as you adhere to the general method signatures and produce the right output.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_hog_feature</span><span class="p">(</span><span class="n">original_image</span><span class="p">,</span> <span class="n">hog_image</span><span class="p">,</span> <span class="n">cell_size</span> <span class="o">=</span> <span class="mi">2</span><span class="p">):</span>
  <span class="k">pass</span>

<span class="k">def</span> <span class="nf">plot_hog_features</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
  <span class="k">pass</span>

<span class="n">plot_hog_features</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># MODEL IMPLEMENTATION</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">skimage.feature</span> <span class="kn">import</span> <span class="n">hog</span>

<span class="k">def</span> <span class="nf">plot_hog_feature</span><span class="p">(</span><span class="n">original_image</span><span class="p">,</span> <span class="n">hog_image</span><span class="p">,</span> <span class="n">cell_size</span> <span class="o">=</span> <span class="mi">2</span><span class="p">):</span>

  <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

  <span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
  <span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">original_image</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span>
  <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Original image&quot;</span><span class="p">)</span>

  <span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
  <span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">hog_image</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span>
  <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;HOG with cellsize </span><span class="si">{}</span><span class="s2">x</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cell_size</span><span class="p">,</span> <span class="n">cell_size</span><span class="p">))</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">plot_hog_features</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
  <span class="n">first_tsu_indexes</span> <span class="o">=</span> <span class="n">y_class</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
  <span class="n">tsu_image</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">first_tsu_indexes</span><span class="p">)]</span>
  <span class="n">tsu_image</span> <span class="o">=</span> <span class="n">tsu_image</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">))</span>

  <span class="n">_</span><span class="p">,</span> <span class="n">tsu_hog_2by2</span> <span class="o">=</span> <span class="n">hog</span><span class="p">(</span><span class="n">tsu_image</span><span class="p">,</span> <span class="n">pixels_per_cell</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">cells_per_block</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">visualize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">tsu_hog_4by4</span> <span class="o">=</span> <span class="n">hog</span><span class="p">(</span><span class="n">tsu_image</span><span class="p">,</span> <span class="n">pixels_per_cell</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">cells_per_block</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">visualize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">tsu_hog_6by6</span> <span class="o">=</span> <span class="n">hog</span><span class="p">(</span><span class="n">tsu_image</span><span class="p">,</span> <span class="n">pixels_per_cell</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">cells_per_block</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">visualize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

  <span class="n">plot_hog_feature</span><span class="p">(</span><span class="n">tsu_image</span><span class="p">,</span> <span class="n">tsu_hog_2by2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">plot_hog_feature</span><span class="p">(</span><span class="n">tsu_image</span><span class="p">,</span> <span class="n">tsu_hog_4by4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
  <span class="n">plot_hog_feature</span><span class="p">(</span><span class="n">tsu_image</span><span class="p">,</span> <span class="n">tsu_hog_6by6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

<span class="n">plot_hog_features</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Assignment_1_Model_Solution_37_0.png" src="../_images/Assignment_1_Model_Solution_37_0.png" />
<img alt="../_images/Assignment_1_Model_Solution_37_1.png" src="../_images/Assignment_1_Model_Solution_37_1.png" />
<img alt="../_images/Assignment_1_Model_Solution_37_2.png" src="../_images/Assignment_1_Model_Solution_37_2.png" />
</div>
</div>
</div>
</div>
<div class="section" id="question-5-2-a-better-model-1-point">
<h2>Question 5.2 : A better model? (1 point)<a class="headerlink" href="#question-5-2-a-better-model-1-point" title="Permalink to this headline">¶</a></h2>
<p>Compute the HOG features for all images in the dataset and train a Logistic Regression model based on the computed features. Explore different cell sizes, and different levels of regularization, to improve your evaluation accuracy while reducing the number of features for each image. Implement a method <code class="docutils literal notranslate"><span class="pre">compute_hog_feats</span></code> that computes all the HOG features, and a method <code class="docutils literal notranslate"><span class="pre">evaluate_hog_lr</span></code> that evaluates the resulting Logistic Regression model and prints out the test set accuracy. You can use a single holdout in this case. Is this model better than the one you found in question 1.2?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_hog_feats</span><span class="p">(</span><span class="n">X_original</span><span class="p">,</span> <span class="n">cell_size</span><span class="p">):</span>
  <span class="k">pass</span>

<span class="k">def</span> <span class="nf">evaluate_hog_lr</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
  <span class="k">pass</span>

<span class="c1"># Don&#39;t forget to explore different cell sizes for HOG</span>
<span class="c1"># compute_hog_feats should be called multiple times</span>
<span class="c1"># Don&#39;t forget to tune the LogisticRegression hyperparameters. This can be done </span>
<span class="c1"># offline, don&#39;t tune them inside evaluate_hog_lr.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># MODEL IMPLEMENTATION</span>
<span class="k">def</span> <span class="nf">compute_hog_feats</span><span class="p">(</span><span class="n">X_original</span><span class="p">,</span> <span class="n">cell_size</span><span class="p">):</span>
  <span class="k">return</span> <span class="p">[</span><span class="n">hog</span><span class="p">(</span><span class="n">crt_img</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> <span class="n">pixels_per_cell</span><span class="o">=</span><span class="p">(</span><span class="n">cell_size</span><span class="p">,</span> <span class="n">cell_size</span><span class="p">),</span> <span class="n">cells_per_block</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">visualize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">crt_img</span> <span class="ow">in</span> <span class="n">X_original</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()]</span>

<span class="k">def</span> <span class="nf">evaluate_hog_lr</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
  <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
  <span class="n">X_train_hog</span> <span class="o">=</span> <span class="n">compute_hog_feats</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">X_test_hog</span> <span class="o">=</span> <span class="n">compute_hog_feats</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

  <span class="n">model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_hog</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test_hog</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>

<span class="n">evaluate_hog_lr</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9169142857142857
</pre></div>
</div>
</div>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"c97a5cd1ff5a4920b44ca288182ff02d": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "43319a8e3b8d45048c8205ede4372e0a": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "363dd20ab3d24939b1e87307e77a8211": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_c97a5cd1ff5a4920b44ca288182ff02d", "max": 12.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_43319a8e3b8d45048c8205ede4372e0a", "value": 12.0}}, "6b69ff0fff304845a33903703ec2ddb0": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "32f70a6066344bf2a4d8db557908fe96": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "d1d961ace61d42968d3ed318d55c2435": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_6b69ff0fff304845a33903703ec2ddb0", "placeholder": "\u200b", "style": "IPY_MODEL_32f70a6066344bf2a4d8db557908fe96", "value": "100%"}}, "8622e318fe3e4e238a4ff5e99ba76588": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c0f6eb7376b8480daedcd72bdae15392": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "df7d92cf0d5a4f8dbc7083dfed9ad287": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_8622e318fe3e4e238a4ff5e99ba76588", "placeholder": "\u200b", "style": "IPY_MODEL_c0f6eb7376b8480daedcd72bdae15392", "value": " 12/12 [00:34&lt;00:00,  3.83s/it]"}}, "0c9858360f6a4f0ab9114c0ed7ee8824": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "08c5695d927d4287af10d94753cd1365": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_d1d961ace61d42968d3ed318d55c2435", "IPY_MODEL_363dd20ab3d24939b1e87307e77a8211", "IPY_MODEL_df7d92cf0d5a4f8dbc7083dfed9ad287"], "layout": "IPY_MODEL_0c9858360f6a4f0ab9114c0ed7ee8824"}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./assignments"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Joaquin Vanschoren<br/>
    
        &copy; Copyright 2021. CC0 Licensed - Use as you like.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>